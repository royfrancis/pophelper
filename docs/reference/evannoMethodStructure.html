<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform the Evanno method for STRUCTURE runs. — evannoMethodStructure • pophelper</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Perform the Evanno method for STRUCTURE runs. — evannoMethodStructure" />

<meta property="og:description" content="The Evanno method for detecting the appropriate number of 
population clusters from STRUCTURE results. Creates table and figure with 
Evanno method derivatives. Refer to return for detailed list of columns. See 
details for Evanno method reference." />

<meta property="og:image" content="https://github.com/royfrancis/pophelper/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pophelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-tools"></span>
     
    Vignette
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-history"></span>
     
    Versions
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/royfrancis/pophelper">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform the Evanno method for STRUCTURE runs.</h1>
    <small class="dont-index">Source: <a href='https://github.com/royfrancis/pophelper/blob/master/R/pophelper.R'><code>R/pophelper.R</code></a></small>
    <div class="hidden name"><code>evannoMethodStructure.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The Evanno method for detecting the appropriate number of 
population clusters from STRUCTURE results. Creates table and figure with 
Evanno method derivatives. Refer to return for detailed list of columns. See 
details for Evanno method reference.</p>
    
    </div>

    <pre class="usage"><span class='fu'>evannoMethodStructure</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>writetable</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>exportplot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>returnplot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>returndata</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>pointsize</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>pointtype</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>pointcol</span> <span class='kw'>=</span> <span class='st'>"steelblue"</span>,
  <span class='kw'>linesize</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>linecol</span> <span class='kw'>=</span> <span class='st'>"steelblue"</span>, <span class='kw'>ebwidth</span> <span class='kw'>=</span> <span class='fl'>0.2</span>,
  <span class='kw'>ebcol</span> <span class='kw'>=</span> <span class='st'>"grey30"</span>, <span class='kw'>textcol</span> <span class='kw'>=</span> <span class='st'>"grey30"</span>, <span class='kw'>xaxisbreaks</span> <span class='kw'>=</span> <span class='fu'>waiver</span>(),
  <span class='kw'>xaxislabels</span> <span class='kw'>=</span> <span class='fu'>waiver</span>(), <span class='kw'>basesize</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>gridsize</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>imgtype</span> <span class='kw'>=</span> <span class='st'>"png"</span>, <span class='kw'>height</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>width</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>dpi</span> <span class='kw'>=</span> <span class='fl'>300</span>,
  <span class='kw'>units</span> <span class='kw'>=</span> <span class='st'>"cm"</span>, <span class='kw'>theme</span> <span class='kw'>=</span> <span class='st'>"theme_bw"</span>, <span class='kw'>font</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>outputfilename</span> <span class='kw'>=</span> <span class='st'>"evannoMethodStructure"</span>,
  <span class='kw'>exportpath</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A dataframe with summarised runs. An output from 
<code><a href='summariseQ.html'>summariseQ()</a></code> derived from STRUCTURE runs. Must have minimum 7 columns 
named elpdmean, elpdsd, k, runs, loci, elpdmax and elpdmin.</p></td>
    </tr>
    <tr>
      <th>writetable</th>
      <td><p>A logical indicating if the output table is to be exported 
as a file in the working directory.</p></td>
    </tr>
    <tr>
      <th>exportplot</th>
      <td><p>A logical indicating if the Evanno plots are to be exported 
as an image in the working directory. If Evanno method cannot be computed, a 
kPlot (elpd over k) is exported instead.</p></td>
    </tr>
    <tr>
      <th>returnplot</th>
      <td><p>A logical indicating if the plot must be returned. A 
gtable object is returned alone when <code>returndata=FALSE</code>. When 
<code>returndata=TRUE</code>, the gtable object is returned in a list. See 'Value'.</p></td>
    </tr>
    <tr>
      <th>returndata</th>
      <td><p>A logical indicating if the data must be returned. A 
data.frame object is returned alone when <code>returnplot=FALSE</code>. When 
<code>returnplot=TRUE</code>, the data.frame object is returned in a list. See 'Value'.</p></td>
    </tr>
    <tr>
      <th>pointsize</th>
      <td><p>A numeric indicating size of points. Default for 
<code>basesize=6</code> is 1.8.</p></td>
    </tr>
    <tr>
      <th>pointtype</th>
      <td><p>A character or number for the type of points. Defaults to 20. 
Same as pch in standard R.</p></td>
    </tr>
    <tr>
      <th>pointcol</th>
      <td><p>A colour character for the colour of points. Defaults to 
"steelblue".</p></td>
    </tr>
    <tr>
      <th>linesize</th>
      <td><p>A numeric indicating the thickness of the line. Default for 
<code>basesize=6</code> is 0.24.</p></td>
    </tr>
    <tr>
      <th>linecol</th>
      <td><p>A colour character for the colour of line. Defaults to 
"steelblue".</p></td>
    </tr>
    <tr>
      <th>ebwidth</th>
      <td><p>A numeric indicating size od width of error abrs. Defaults to 
0.2.</p></td>
    </tr>
    <tr>
      <th>ebcol</th>
      <td><p>A colour character for colour for errorbar. Defaults to "grey30".</p></td>
    </tr>
    <tr>
      <th>textcol</th>
      <td><p>A colour character for all text elements on the plot. 
Defaults to "grey30".</p></td>
    </tr>
    <tr>
      <th>xaxisbreaks</th>
      <td><p>A numeric vector indicating x-axis breaks. Automatically 
calculated by default.</p></td>
    </tr>
    <tr>
      <th>xaxislabels</th>
      <td><p>A character vector indicating x-axis labels. Automatically 
calculated by default.</p></td>
    </tr>
    <tr>
      <th>basesize</th>
      <td><p>A numeric indicating the base size of various plot elements 
such as pointsize, linesize etc. Increase basesize with larger figure 
dimensions. Defaults to 6. Manually specified arguments (eg: pointsize) 
override basesize.</p></td>
    </tr>
    <tr>
      <th>gridsize</th>
      <td><p>A numeric indicating thickness of background grid. Default 
for <code>basesize=6</code> is 0.18.</p></td>
    </tr>
    <tr>
      <th>imgtype</th>
      <td><p>A character indicating the type of exported image. Default 
set to 'png'. Other possible 
options are 'jpeg', 'tiff' or 'pdf'.</p></td>
    </tr>
    <tr>
      <th>height</th>
      <td><p>A numeric denoting the height of exported image. Default units 
in 'cm'.</p></td>
    </tr>
    <tr>
      <th>width</th>
      <td><p>A numeric denoting the width of exported image. Default units in 
'cm'.</p></td>
    </tr>
    <tr>
      <th>dpi</th>
      <td><p>A numeric denoting the resolution of exported image. Default set 
to 300. If <code>imgtype="pdf"</code>, dpi is fixed at 300.</p></td>
    </tr>
    <tr>
      <th>units</th>
      <td><p>A character denoting the unit of measure of the export image. 
Default is 'cm'. Other options are 'px', 'in' or 'mm'.</p></td>
    </tr>
    <tr>
      <th>theme</th>
      <td><p>A character indicating ggplot theme to be used. Use like 
"theme_grey", "theme_bw" etc.</p></td>
    </tr>
    <tr>
      <th>font</th>
      <td><p>A character indicating font family to be used in the plots. 
Uses default system fonts by default for jpeg, png and tiff. Uses 'Helvetica' 
as default for pdf. Use package <code>extrafonts</code> to import custom fonts. 
See vignette for examples.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>Default set to FALSE. Does not remove NAs for plot and this 
generates warnings from <code>ggplot</code>. If set to TRUE, NAs are removed before 
plotting and warning messages from <code>ggplot</code> are avoided.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>A logical indicating if messages must be printed to console.</p></td>
    </tr>
    <tr>
      <th>outputfilename</th>
      <td><p>A character indicating output file name. Defaults to 
'evannoMethodStructure'.</p></td>
    </tr>
    <tr>
      <th>exportpath</th>
      <td><p>A path to where content must be exported. For example,
<code>"./dir/anotherdir/"</code>. Defaults to NULL which means current working
directory.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>When <code>returndata=TRUE</code> and <code>returnplot=FALSE</code>, a data.frame is 
returned.
When <code>returndata=FALSE</code> and <code>returnplot=TRUE</code>, a gtable plot object is 
returned.
When <code>returndata=TRUE</code> and <code>returnplot=TRUE</code>, a list with data.frame 
and gtable object is returned.</p>
<p>The data.frame contains Evanno results sorted by K. The table has 16 
columns namely Mean estimated ln probability of data, Standard deviation, 
Value of K, Number of runs for each K, Number of runs for each K, Number of 
individuals for each K, Number of loci for each K, Estimated ln probability 
of data plus standard deviation, Estimated ln probability of data minus 
standard deviation, First derivative, Max error of first derivative, Min 
error of first derivative, Second derivative, Max error of second derivative, 
Min error of second derivative and the Third derivative.</p>
<p>The gtable object is a result of <code><a href='https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html'>gridExtra::arrangeGrob()</a></code>. This is 
suitable for plotting in a report.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The Evanno method is based on the paper: Evanno, G., Regnaut, S., 
and Goudet, J. (2005). Detecting the number of clusters of individuals using 
the software STRUCTURE: a simulation study. Molecular ecology, 14(8), 
2611-2620. The Evanno plot generated from this function can be recreated 
from the returned dataframe if furthur customisation is required.</p>
<p>See the vignette for more details.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='no'>sfiles</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='kw'>path</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"files/structure"</span>,<span class='kw'>package</span><span class='kw'>=</span><span class='st'>"pophelper"</span>),
<span class='kw'>full.names</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>tr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='tabulateQ.html'>tabulateQ</a></span>(<span class='fu'><a href='readQ.html'>readQ</a></span>(<span class='no'>sfiles</span>))
<span class='no'>sr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='summariseQ.html'>summariseQ</a></span>(<span class='no'>tr1</span>)
<span class='fu'>evannoMethodStructure</span>(<span class='no'>sr1</span>)
<span class='fu'>evannoMethodStructure</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>sr1</span>,<span class='kw'>exportplot</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roy Francis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


